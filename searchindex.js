Search.setIndex({"docnames": ["background/index", "background/key_features", "background/other_choices", "background/terminology", "bibliography/bibliography", "developer/design/allocator", "developer/design/buffer", "developer/design/distribution", "developer/design/expression", "developer/design/index", "developer/design/motivation", "developer/design/op_graph", "developer/design/overview", "developer/design/shape", "developer/design/sparsity", "developer/design/symmetry", "developer/design/tensor_wrapper", "developer/index", "index", "sparse_maps/background", "sparse_maps/design", "sparse_maps/from_sparse_map", "sparse_maps/index"], "filenames": ["background/index.rst", "background/key_features.rst", "background/other_choices.rst", "background/terminology.rst", "bibliography/bibliography.rst", "developer/design/allocator.rst", "developer/design/buffer.rst", "developer/design/distribution.rst", "developer/design/expression.rst", "developer/design/index.rst", "developer/design/motivation.rst", "developer/design/op_graph.rst", "developer/design/overview.rst", "developer/design/shape.rst", "developer/design/sparsity.rst", "developer/design/symmetry.rst", "developer/design/tensor_wrapper.rst", "developer/index.rst", "index.rst", "sparse_maps/background.rst", "sparse_maps/design.rst", "sparse_maps/from_sparse_map.rst", "sparse_maps/index.rst"], "titles": ["TensorWrapper Background", "Key Features of TensorWrapper", "Existing Tensor Libraries", "TensorWrapper Terminology", "References", "Designing the Allocator", "Designing the Buffer", "Layout Design", "Designing the Expression Component", "Design of TensorWrapper", "Motivating TensorWrapper", "Designing the OpGraph", "Overview of TensorWrapper", "Tensor Shape Design", "Tensor Sparsity Design", "Designing the Symmetry Component", "Designing TensorWrapper Class", "Developer Documentation", "TensorWrapper", "SparseMap Background", "Sparse Map Library Design", "Sparsifying a Tensor", "Sparse Maps Sublibrary"], "terms": {"kei": [0, 12, 13, 18, 22], "featur": [0, 10, 12, 13, 18], "design": [0, 3, 17, 18, 22], "math": [0, 3, 6, 12], "exist": [0, 1, 3, 6, 12, 13, 15, 18, 20, 21], "tensor": [0, 4, 5, 9, 11, 12, 17, 18, 19, 22], "librari": [0, 1, 6, 10, 12, 18, 22], "cyclop": 0, "framework": [0, 4], "ctf": 0, "fastor": 0, "ftensor": 0, "intellig": 0, "itensor": 0, "libtensor": 0, "pytorch": 0, "algebra": [0, 12], "compil": [0, 10, 13], "taco": 0, "c": [0, 1, 12, 13, 16, 18], "tiledarrai": 0, "terminologi": [0, 9, 18], "comput": [0, 1, 4, 6, 10, 12, 13], "scienc": [0, 4], "mathemat": [0, 6, 12, 13, 15], "There": [1, 2, 12, 21], "ar": [1, 2, 3, 5, 6, 7, 9, 11, 12, 13, 14, 15, 16, 19, 20, 21], "lot": [1, 10, 15], "out": [1, 3, 10, 13, 20, 21], "point": [1, 3, 10, 12, 13, 15, 20, 21], "thi": [1, 3, 5, 6, 10, 12, 13, 14, 15, 16, 20, 21], "page": [1, 13, 14, 15, 21], "i": [1, 2, 3, 5, 9, 10, 11, 16, 19, 20, 21], "keep": [1, 7], "track": [1, 5, 7, 12, 13], "what": [1, 2, 3, 9], "set": [1, 3, 6, 12, 13, 15, 20, 21], "part": [1, 3, 6, 12, 15], "To": [1, 6, 12, 13, 21], "extent": [1, 2, 12, 13], "possibl": [1, 6, 10, 12, 13, 15], "aim": [1, 13], "graft": 1, "other": [1, 3, 6, 10, 12, 13, 15, 21], "list": [1, 2, 3, 13], "admittedli": [1, 13], "requir": [1, 3, 6, 12, 13, 15, 20, 21], "factor": [1, 12, 13, 15, 20], "practic": [1, 3, 6, 10, 12, 13, 19], "we": [1, 2, 3, 9, 10, 11, 19, 20, 21], "have": [1, 2, 3, 5, 6, 10, 11, 12, 13, 14, 15, 20, 21], "reimplement": [1, 12], "sinc": [1, 3, 5, 10, 13, 21], "said": [1, 12, 15], "usual": [1, 3, 6, 10, 12, 13, 15], "modular": 1, "some": [1, 5, 6, 7, 11, 12, 13, 15], "function": [1, 2, 20, 21], "most": [1, 10, 12, 13, 14, 15, 21], "an": [1, 3, 5, 7, 10, 12, 13, 15, 21], "which": [1, 3, 6, 7, 10, 12, 13, 14, 15, 19, 20, 21], "reli": [1, 12, 13], "meta": [1, 13], "templat": [1, 12, 20], "program": [1, 3, 10], "build": [1, 6, 12], "up": [1, 6, 10, 12, 13, 15, 21], "represent": [1, 3, 12], "user": [1, 3, 6, 13, 14, 15, 21], "want": [1, 3, 6, 7, 10, 12, 13, 15, 21], "befor": [1, 5, 6, 12], "run": [1, 13, 14], "from": [1, 3, 6, 10, 12, 13, 15, 19, 20, 21], "languag": [1, 10, 12], "perspect": [1, 15], "domain": [1, 10, 12, 19, 21, 22], "specif": [1, 6, 10, 12, 13, 14, 15], "dsl": [1, 6, 9, 12], "repres": [1, 3, 6, 12, 13], "concret": [1, 12, 21], "syntax": [1, 6, 12, 13], "tree": [1, 12], "cst": [1, 12], "our": [1, 6, 10, 12, 13, 14, 15, 21], "knowledg": [1, 12, 21], "all": [1, 3, 6, 10, 12, 13, 15, 20, 21], "execut": [1, 12], "potenti": [1, 6, 10, 14], "after": [1, 6, 12], "optim": [1, 6, 10, 12, 13], "order": [1, 2, 3, 5, 12, 13, 15], "request": [1, 6, 12], "result": [1, 3, 5, 6, 11, 12, 13, 14, 15, 21], "The": [1, 2, 3, 5, 6, 7, 10, 11, 12, 13, 14, 15, 20, 21], "problem": [1, 12, 13, 14], "approach": [1, 6], "implement": [1, 10, 13, 14, 20], "behind": 1, "individu": [1, 3], "oper": [1, 3, 5, 6, 10, 12, 14, 15, 20], "becom": 1, "coupl": [1, 4], "": [1, 2, 3, 6, 9, 10, 12, 15], "becaus": [1, 3, 10, 12, 13, 15], "written": [1, 10], "term": [1, 3, 10, 12, 13, 15, 19], "follow": [1, 2, 12, 13, 15], "pars": 1, "procedur": 1, "convert": [1, 6, 12, 14, 21], "abstract": [1, 12], "ast": [1, 12], "occur": [1, 12, 13, 15, 21], "In": [1, 5, 6, 10, 12, 13, 14, 15, 19, 21], "turn": [1, 12, 13], "serv": [1, 13, 15], "intermedi": [1, 10, 12], "ti": [1, 12], "front": 1, "end": [1, 12, 13, 15], "distribut": [1, 3, 9, 12, 13], "concept": [1, 3, 20], "tile": [1, 7, 12, 13, 14, 15, 20, 21], "ultim": [1, 6, 12, 15], "data": [1, 4, 6, 12, 13, 20, 21], "done": [1, 6, 12, 13], "differ": [1, 3, 6, 10, 11, 12, 13, 15, 20], "than": [1, 3, 5, 6, 12, 13, 15, 21], "local": [1, 6], "increas": 1, "its": [1, 3, 5, 6, 12, 13, 15, 19], "rank": [1, 6, 12, 13, 15, 16, 21], "e": [1, 3, 6, 7, 10, 12, 13, 14, 15, 20, 21], "g": [1, 6, 7, 12, 13, 14, 15, 20], "matrix": [1, 3, 13, 15], "along": [1, 3, 13], "row": [1, 3, 7, 12, 13, 15], "column": [1, 3, 7, 12, 13], "four": [1, 12, 20], "need": [1, 3, 5, 9, 10, 20], "two": [1, 3, 6, 10, 12, 13, 14, 15, 21], "indic": [1, 3, 5, 12, 13, 14, 15, 20, 21], "select": [1, 12], "element": [1, 5, 6, 7, 10, 12, 13, 14, 15, 20, 21], "within": [1, 3, 12], "howev": [1, 6, 10, 12, 13, 15], "still": [1, 13, 14, 15], "try": [1, 12], "treat": [1, 6, 13, 15], "being": [1, 3, 6, 10, 12, 13, 15], "same": [1, 3, 10, 12, 13, 15, 20, 21], "un": 1, "opinion": [1, 6], "somewhat": [1, 6, 13], "awkward": 1, "mode": [1, 2, 12, 13, 14, 15, 21], "origin": [1, 3, 13, 15], "solut": [1, 6], "distinguish": 1, "between": [1, 3, 6, 10, 12], "how": [1, 3, 6, 10, 12, 13, 15, 20], "declar": [1, 13, 15], "includ": [1, 3, 12], "ani": [1, 3, 5, 10, 15], "addit": [1, 3, 6, 9, 10, 12, 13, 20], "ad": [1, 6, 12, 13, 15, 21], "perform": [1, 3, 4, 5, 6, 13, 15], "reason": [1, 12, 13, 15, 20, 21], "while": [1, 3, 6, 10, 12, 13, 15], "propens": 1, "think": [1, 3, 12, 13, 15], "scalar": [1, 3, 6, 10, 13, 15], "case": [1, 6, 12, 13, 15], "For": [1, 3, 6, 7, 12, 13, 14, 15, 21], "exampl": [1, 3, 10, 11, 12, 13, 15], "can": [1, 3, 5, 6, 7, 10, 12, 13, 14, 15, 20], "also": [1, 2, 3, 6, 10, 12, 13, 15], "thought": [1, 3, 12], "vector": [1, 3, 7, 10, 12, 13, 15, 19], "view": [1, 13], "second": [1, 13, 15, 21], "provid": [1, 2, 3, 6, 12, 13, 15, 21], "singl": [1, 12, 13, 15, 20], "offset": [1, 3, 13, 21], "meaning": 1, "outer": [1, 13, 15, 21], "altern": 1, "map": [1, 3, 12, 13, 14, 15, 18, 19, 21], "them": [1, 6, 12, 13, 15], "more": [1, 3, 5, 6, 7, 10, 12, 13, 14, 15, 21], "tradit": [1, 3, 13], "would": [1, 6, 10, 13, 15, 20], "particular": [1, 3, 6, 7, 12, 15], "slice": [1, 12, 15, 21], "allow": [1, 6, 13, 15], "natur": [1, 10, 13], "open": 1, "door": 1, "n": [1, 3, 6, 10, 12, 13, 15], "m": [1, 15], "contain": [1, 3, 6, 7, 12, 13, 14, 15, 21], "scenario": [1, 6, 13, 15, 21], "each": [1, 3, 6, 7, 10, 11, 12, 13, 15, 19, 20], "inner": [1, 13, 15, 21], "ha": [1, 3, 6, 10, 12, 13, 15], "shape": [1, 2, 6, 9, 14, 15, 16, 17], "One": [1, 13, 15], "imagin": 1, "where": [1, 6, 7, 10, 12, 13, 15, 16], "do": [1, 3, 5, 9], "If": [1, 3, 6, 13, 14, 15, 21], "length": [1, 3, 13], "mai": [1, 3, 6, 11, 12, 13, 15, 21], "seem": [1, 13], "exot": [1, 13, 15], "thei": [1, 2, 3, 6, 10, 11, 12, 13, 15], "quit": [1, 10, 13], "spars": [1, 7, 14, 18, 19], "implicit": [1, 6], "zero": [1, 3, 5, 12, 13, 14, 15], "awar": [2, 5, 12, 13, 15], "ton": 2, "limit": 2, "ourselv": 2, "alphabet": [2, 3], "github": [2, 12], "1": [2, 3, 4, 10, 12, 13, 15, 21], "focus": [2, 12, 13], "known": [2, 6, 12, 13], "total": [2, 3, 13, 15], "size": [2, 13], "must": [2, 3, 5, 6, 7, 12, 13, 15, 21], "advanc": 2, "just": [2, 6, 10, 13, 15], "number": [2, 3, 5, 10, 12, 13], "those": [2, 6, 12, 13, 15], "gitlab": 2, "doc": 2, "know": [2, 6, 12, 13, 15], "you": [2, 6, 10, 13], "re": [2, 10, 13], "sai": [2, 3, 15, 21], "wait": [2, 6], "python": 2, "well": [2, 12, 13], "api": [2, 9, 10, 12, 14, 18, 20], "so": [2, 6, 10, 12, 13, 15], "when": [3, 6, 12, 13, 15], "discuss": [3, 12, 13], "research": 3, "us": [3, 6, 10, 12, 13, 15, 19, 20, 21], "section": [3, 12, 13], "glossari": 3, "throughout": 3, "A": [3, 4, 6, 13, 15, 19], "similar": [3, 13], "lower": [3, 15], "distinct": 3, "import": [3, 6, 12], "ambigu": 3, "associ": [3, 13, 15, 21], "take": [3, 10, 12, 13, 21], "one": [3, 6, 7, 12, 13, 15, 21], "ask": 3, "first": [3, 6, 13, 15, 21], "doe": [3, 6, 10, 15], "v": [3, 7, 12, 13, 19, 20], "resolv": 3, "get": [3, 6, 13, 21], "back": [3, 12], "typic": [3, 6, 12, 13, 14, 15], "hyper": [3, 12, 13], "rectangular": [3, 12, 13], "arrai": [3, 10, 12, 13], "float": [3, 12, 13], "valu": [3, 5, 6, 10, 12, 13, 14, 15], "These": [3, 7, 12, 13, 21], "integ": [3, 13], "string": 3, "even": [3, 12, 13], "form": [3, 13, 15, 21], "specifi": [3, 6, 12, 13, 15], "common": [3, 12, 13, 15, 20], "name": [3, 15], "compon": [3, 6, 7, 9, 12, 13, 14, 17], "outsid": 3, "dimension": [3, 10, 13, 15], "mathbf": [3, 15], "j": [3, 4, 13], "j_i": 3, "k_i": [3, 10], "themselv": [3, 15], "put": [3, 12, 15], "anoth": [3, 6, 12, 15], "wai": [3, 5, 6, 13, 15, 19, 21], "let": [3, 19], "th": [3, 10, 13, 21], "matric": [3, 13, 15], "tabl": [3, 12], "thu": [3, 12, 13, 14, 15, 21], "entri": [3, 12], "etc": [3, 12, 20], "gener": [3, 5, 6, 7, 10, 12, 13, 15], "refer": [3, 10, 13, 14, 15, 18], "higher": [3, 13, 15], "dimens": [3, 10], "analog": [3, 6], "liter": [3, 5, 6], "geometri": 3, "laid": 3, "geometr": 3, "rectangl": 3, "squar": [3, 10, 12], "prism": 3, "cube": 3, "standard": [3, 12, 15], "speak": [3, 12, 13, 15, 19], "multilinear": 3, "over": [3, 6, 12, 13, 21], "defin": [3, 10, 12, 13, 14, 15, 21], "assum": [3, 6, 10, 11, 15, 21], "real": [3, 12], "complex": [3, 12, 15], "restrict": 3, "inde": 3, "sometim": [3, 5, 12, 13], "find": [3, 10, 15], "whose": [3, 6, 13], "greater": [3, 15], "0": [3, 10, 13, 15, 16, 21], "2": [3, 10, 12, 13, 15, 16], "edg": 3, "store": [3, 6, 7, 10, 12, 13, 14, 15, 19, 20], "inform": [3, 5, 6, 12, 13], "sub": [3, 13], "proper": 3, "less": [3, 10, 12, 15, 21], "wide": [3, 12], "help": [3, 12, 15], "introduc": [3, 12, 13, 15], "contrast": [3, 6, 15], "everi": [3, 6, 7, 12, 15], "pair": [3, 13, 15], "With": [3, 12, 13], "respect": [3, 10, 15], "sourc": [3, 11], "code": [3, 10, 12, 13, 15, 21], "structur": [3, 6, 11, 12, 13, 14], "programm": [3, 12], "wrote": 3, "wherea": [3, 12], "carri": 3, "instruct": 3, "easier": [3, 12], "travers": 3, "versu": 3, "extran": [3, 12], "been": [3, 6, 12, 13, 15], "remov": 3, "detail": [3, 6, 12, 21], "chose": [3, 13], "distil": 3, "essenti": 3, "lead": [3, 12, 14, 15], "target": [3, 13], "applic": [3, 4], "compar": 3, "purpos": [3, 6, 12, 13, 14, 15], "tend": 3, "fewer": 3, "primit": [3, 13], "account": [3, 12, 15], "onli": [3, 6, 7, 12, 13, 15], "concern": [3, 13, 20], "itself": [3, 15, 20], "enough": 3, "express": [3, 9, 10, 13, 15, 17], "make": [3, 6, 12, 13, 16], "easi": 3, "manner": [3, 5, 6, 12, 15, 21], "multipl": [3, 6, 10, 11, 13, 15, 20], "behav": 3, "like": [3, 6, 10, 12, 13, 15, 16, 20], "both": [3, 6, 13, 15, 21], "commut": 3, "final": [3, 15], "non": [3, 7, 13, 14, 15], "poss": 3, "invers": 3, "roman": 4, "poya": 4, "antonio": 4, "gil": 4, "rogelio": 4, "ortigosa": 4, "high": [4, 6, 12], "parallel": [4, 10], "contract": [4, 12, 13, 14], "electro": 4, "mechan": [4, 5, 12, 13, 15], "physic": [4, 6, 10, 12, 13, 19], "commun": [4, 6], "2017": 4, "url": 4, "http": [4, 12], "www": 4, "sciencedirect": 4, "com": [4, 12], "articl": 4, "pii": 4, "s0010465517300681": 4, "doi": 4, "dx": 4, "org": 4, "10": [4, 13, 15, 16], "1016": 4, "cpc": 4, "02": 4, "016": 4, "runtim": [5, 12, 13], "charg": [5, 12, 20], "buffer": [5, 9, 16, 17, 21], "object": [5, 6, 7, 10, 11, 12, 13, 14, 20, 21], "access": [5, 6, 13, 15], "process": [5, 6, 7, 10, 12, 13, 14], "amount": [5, 14, 15], "avail": [5, 6], "memori": [5, 7, 10, 13, 15, 20], "state": [5, 6, 7, 12, 15], "respons": [5, 6, 12, 13, 14, 15], "parallelzon": [5, 12], "input": [5, 11, 12, 13, 15], "initi": [5, 6, 12, 13, 16], "fill": [5, 6, 12, 15, 21], "ident": [5, 6, 12, 13], "often": [5, 6, 12, 13], "depend": [5, 6, 15, 21], "block": [5, 15], "arbitrari": 5, "abl": [5, 6, 10, 12, 13, 21], "suitabl": [5, 6], "assign": [5, 6, 13, 15], "lightweight": 5, "hierarchi": [5, 13, 15, 22], "support": [5, 6], "creat": [5, 12, 13, 15, 21], "instanc": [5, 13, 15, 21], "vastli": 6, "simplifi": [6, 12, 14], "consist": [6, 15], "thing": [6, 10, 12, 22], "properti": [6, 12, 13], "impos": [6, 13], "top": [6, 12, 13], "class": [6, 9, 13, 15, 17, 21, 22], "hold": [6, 20], "describ": [6, 12, 13, 15], "held": 6, "tensorwrapp": [6, 11, 13, 14, 15, 17], "power": 6, "boundari": 6, "interfac": [6, 12], "through": [6, 14], "intent": [6, 10], "convei": [6, 12], "backend": [6, 10, 12, 13], "remot": 6, "piec": [6, 12, 21], "By": [6, 10, 12, 13, 15, 20], "futur": 6, "eventu": 6, "time": [6, 13, 14], "creation": 6, "actual": [6, 10, 12, 13, 20], "yet": 6, "aris": [6, 11, 13, 15], "task": 6, "schedul": 6, "background": [6, 18, 22], "control": 6, "continu": 6, "onc": [6, 12, 15], "complet": [6, 13], "directli": 6, "until": [6, 12, 15], "readi": 6, "lazi": [6, 7], "live": [6, 7, 12], "instead": [6, 20], "fly": [6, 7, 12], "immedi": [6, 7], "delai": 6, "current": [6, 12], "without": [6, 13, 15, 20], "opposit": 6, "none": [6, 13], "layout": [6, 9, 13, 17], "veri": 6, "complic": [6, 7, 10, 12, 15], "mani": [6, 12, 13, 14, 15], "alreadi": [6, 12], "reinvent": 6, "suggest": [6, 15], "should": [6, 12, 13, 15], "type": [6, 11, 12, 14, 15, 16, 20, 21], "erasur": 6, "As": [6, 10, 12, 13, 15], "doubl": [6, 10, 12], "rather": 6, "variou": [6, 12, 13, 15], "interoper": [6, 12], "eras": [6, 12], "unwrap": 6, "too": [6, 12, 13, 15], "expos": [6, 13, 15], "locat": [6, 12], "interact": [6, 12, 13, 14, 15], "seen": [6, 10], "see": [6, 12, 13], "replic": [6, 7, 12], "handl": 6, "particularli": 6, "explicitli": [6, 13], "seamlessli": 6, "implicitli": [6, 14, 20], "lazili": 6, "asynchron": 6, "abil": 6, "proxi": 6, "Such": [6, 12], "meantim": 6, "queue": 6, "attempt": 6, "figur": [6, 12], "tell": [6, 7, 12, 13], "involv": [6, 12, 14, 15, 20], "record": [6, 12], "pass": [6, 13, 21], "arguabl": [6, 13], "fundament": [6, 12, 14], "realiti": [6, 12], "go": [6, 12, 21], "unifi": [6, 12, 13, 21], "difficult": 6, "better": [6, 10, 12, 15], "cover": [6, 21], "alloc": [6, 9, 16, 17, 21], "abov": [6, 13], "heavili": [6, 12], "punt": [6, 10, 13, 15], "exact": 6, "beyond": [6, 15], "now": [6, 21], "opaqu": [6, 12], "invoc": 6, "auto": [6, 10, 13], "get_shap": 6, "get_alloc": 6, "lambda": [6, 21], "lambda_fxn": 6, "inspect": [6, 12], "basic": [6, 20], "get_buff": 6, "enum": 6, "b": [6, 12, 13, 15], "scalar_typ": 6, "element_typ": 6, "flesh": 6, "anticip": 6, "regularli": 6, "make_buff": 6, "eigen": 6, "unwrapped_tensor_typ": 6, "3": [6, 13, 15, 16], "eigen_t": 6, "determin": [6, 12, 13], "insid": 6, "return": [6, 10, 13, 21], "either": [6, 13, 20], "throw": [6, 13], "error": 6, "distributedbuff": 6, "extend": 6, "underli": [6, 10, 13], "across": 6, "dist_buff": 6, "localbuff": 6, "my_buff": 6, "local_buff": 6, "NOT": [6, 13, 15], "though": [6, 13], "remotebuff": 6, "a_buff": 6, "rang": [6, 15, 20], "pull": 6, "replicatedbuff": 6, "replicated_buff": 6, "seri": [6, 12, 13, 14, 15, 20], "annotatedtensor": 6, "trigger": [6, 12], "full": [6, 10, 15, 21], "note": [6, 9, 13, 20, 22], "necessari": [6, 12, 15], "about": [6, 12], "graph": [6, 11], "get_op_graph": 6, "visitor": 6, "pattern": [6, 12], "automat": 6, "downcast": 6, "null": [7, 15], "somewher": 7, "u": [7, 10, 12, 13, 19, 20, 21], "small": [7, 13], "core": 7, "format": 7, "major": [7, 12, 15], "superflu": 7, "larger": 7, "don": 7, "t": [7, 10, 12, 13, 15, 16, 21], "own": [7, 15], "eager": 7, "built": 7, "delet": 7, "theoret": 7, "mix": [7, 15], "hardwar": 7, "1st": 7, "gpu": [7, 10, 12], "motiv": [9, 12, 17], "why": 9, "suffici": 9, "overview": [9, 17], "architectur": [9, 13], "consider": [9, 22], "propos": 9, "summari": 9, "symmetri": [9, 13, 17], "consid": [9, 10, 12, 13], "sparsiti": [9, 13, 15, 17, 19, 20], "opgraph": [9, 17], "multi": [10, 12], "mean": [10, 13, 14, 15, 21], "index": [10, 13, 15, 20, 21], "quantiti": 10, "accord": 10, "given": [10, 12, 15, 21], "preval": 10, "equat": [10, 12], "theori": [10, 11, 12, 15], "succinctli": [10, 12], "perfect": 10, "energi": 10, "harmon": 10, "oscil": 10, "frac": 10, "sum_": 10, "left": [10, 12, 13], "r_i": 10, "r": [10, 13, 15], "_i": 10, "right": [10, 12, 13], "forc": 10, "constant": 10, "displac": 10, "simpl": 10, "few": 10, "peopl": 10, "bring": 10, "someth": [10, 15], "dr": 10, "r0": 10, "k": [10, 13], "5": [10, 13], "That": [10, 12, 13, 15], "d": 10, "loop": [10, 21], "pseudo": 10, "base": [10, 11, 12, 14, 15], "version": 10, "dr2": 10, "ignor": 10, "face": 10, "count": 10, "algorithm": [10, 13, 15, 22], "subtract": [10, 12, 13], "dot": 10, "product": [10, 13, 15], "primari": [10, 15], "strictli": [10, 12, 15], "inferr": 10, "present": [10, 12, 15, 21], "here": [10, 15], "akin": 10, "produc": [10, 14], "overal": [10, 12, 15], "short": 10, "answer": 10, "situat": [10, 14], "modern": 10, "orient": 10, "techniqu": 10, "disconnect": 10, "appar": 10, "look": [10, 12, 13, 16], "extra": 10, "usag": 10, "doesn": 10, "realli": [10, 12, 13], "could": [10, 12, 13, 15], "identifi": 10, "furthermor": [10, 12, 14], "entir": [10, 13, 15], "acceler": 10, "rewritten": 10, "thread": 10, "work": [10, 12, 13, 14, 15, 21], "strive": [10, 12], "achiev": [10, 12], "willing": 10, "drop": 10, "precis": 10, "interest": [10, 13, 14, 15], "node": [11, 12], "sink": 11, "whether": [11, 12, 14, 15], "termin": 11, "electron": [11, 12], "level": 12, "varieti": 12, "encount": 12, "friendli": [12, 14], "awai": 12, "much": 12, "nearli": 12, "law": 12, "summar": [12, 13], "naiv": 12, "subject": [12, 15], "impli": 12, "leav": 12, "nonetheless": 12, "argu": 12, "facilit": [12, 15], "translat": 12, "encapsul": [12, 20], "read": 12, "ration": 12, "capabl": 12, "certain": 12, "break": 12, "place": [12, 20], "onu": 12, "goal": [12, 21], "middl": 12, "layer": [12, 13, 15], "decoupl": 12, "workflow": 12, "expect": [12, 13], "adopt": 12, "performantli": 12, "meet": 12, "At": [12, 21], "highest": [12, 15], "permut": [12, 13, 21], "step": 12, "intrins": 12, "modifi": 12, "below": 12, "enforc": 12, "fact": [12, 15], "knock": 12, "start": [12, 13, 15, 21], "option": 12, "suppli": 12, "implic": 12, "notabl": 12, "special": [12, 13, 15, 20, 21], "compos": [12, 13], "add": [12, 13, 21], "wise": [12, 13], "evalu": 12, "afford": [12, 21], "nice": 12, "accomplish": 12, "interlac": 12, "previou": [12, 13], "ideal": [12, 13], "autom": 12, "merg": 12, "surround": 12, "logic": [12, 13], "reflect": [12, 13], "model": [12, 13, 20], "under": [12, 14, 15, 16], "hood": [12, 14, 15, 16], "vari": [12, 15], "condit": 12, "sort": [12, 15], "Will": 12, "updat": 12, "cpu": 12, "ram": 12, "disk": 12, "statu": 12, "similarli": [12, 13], "choos": [12, 15], "collect": 12, "static": 12, "analyz": 12, "minim": [12, 13, 15], "context": [12, 14], "preconceiv": 12, "notion": 12, "aren": [12, 13], "brought": 12, "happen": 12, "simpli": [12, 13, 15], "write": 12, "spin": 12, "spatial": 12, "molecular": 12, "system": 12, "histor": 12, "reusabl": 12, "inspir": 12, "interject": 12, "fig": [12, 13, 15], "illustr": 12, "mention": 12, "constructor": [12, 13, 15], "show": [12, 13, 15], "organ": 12, "categori": [12, 15], "primarili": [12, 13, 15], "main": [12, 21], "nest": [12, 15], "commonli": 12, "discov": 12, "relationship": 12, "tool": 12, "exploit": [12, 14], "antisymmetri": [12, 13], "hermitian": [12, 13, 15], "anti": [12, 13, 15], "deal": [12, 13], "sign": [12, 15], "switch": 12, "among": [12, 15], "leaf": 12, "addition": [12, 13, 15], "descript": 12, "elect": 12, "upon": 12, "nwchemex": 12, "project": 12, "__": 12, "shown": 12, "sever": 12, "wrap": 12, "appropri": 12, "strategi": 12, "avoid": [12, 13, 15, 20], "routin": 12, "effort": 12, "attach": 12, "move": [12, 13, 21], "independ": [12, 13, 21], "And": [12, 13], "opt": 12, "enter": 12, "appear": [12, 15], "assembl": [12, 15], "transform": 12, "binari": 12, "branch": 12, "csl": 12, "instanti": 12, "fun": 12, "manipul": [12, 13], "It": [12, 13, 15, 20], "drive": 12, "advantag": 12, "captur": [13, 15], "noth": 13, "bunch": 13, "conceptu": [13, 15], "arrang": 13, "lai": 13, "theme": 13, "asid": 13, "possibli": 13, "smooth": 13, "flatten": 13, "4": [13, 15, 16], "destroi": 13, "partit": 13, "hint": 13, "pertain": 13, "hierarch": 13, "ness": 13, "truli": 13, "treatment": 13, "least": 13, "combin": [13, 15], "output": [13, 15], "absolut": 13, "alwai": [13, 15], "rel": 13, "linearli": 13, "redund": [13, 15], "fall": 13, "intern": [13, 15], "mask": 13, "contigu": 13, "were": 13, "therefor": 13, "revers": 13, "subcategori": 13, "satisfi": [13, 15], "develop": [13, 18], "except": 13, "again": 13, "conveni": 13, "address": 13, "nestedshap": 13, "chang": [13, 20], "affect": 13, "technic": 13, "oblivi": 13, "null_shap": 13, "No": 13, "rank0_shap": 13, "rank1_shap": 13, "rank2_shap": 13, "20": [13, 15, 16], "rank3_shap": 13, "30": [13, 15, 16], "rule": 13, "line": 13, "call": 13, "default": [13, 15, 16], "ctor": [13, 15], "somehow": 13, "size_typ": 13, "std": [13, 21], "get_ext": 13, "runtime_rank_shap": 13, "begin": 13, "breviti": 13, "variabl": 13, "s10": 13, "s20": 13, "s30": 13, "s10_20": 13, "s30_40": 13, "40": [13, 16], "s50_60": 13, "50": 13, "60": 13, "s10_20_30": 13, "s40_50_60": 13, "smooth0_shap": 13, "smooth1_shap": 13, "smooth2_shap": 13, "rank2_shape2": 13, "rank3_shape2": 13, "st": 13, "rank4_shap": 13, "rank4_shape2": 13, "word": [13, 21], "equival": [13, 15], "e00": [13, 15], "e01": 13, "e10": 13, "e11": [13, 15], "e12": 13, "e0": 13, "e1": 13, "recurs": [13, 14], "slice_shap": 13, "get_slic": 13, "far": [13, 15], "15": 13, "chunk": 13, "verbos": 13, "crate": 13, "via": 13, "s0": [13, 15], "s0_0": 13, "s1": [13, 15], "s1_0": 13, "s0_1": 13, "s2_0": 13, "per": [13, 15], "s1_1": 13, "s0_2": 13, "s3": [13, 15], "s1_2": 13, "three": [13, 15], "s1_1_1": 13, "assert": 13, "6000": 13, "6200": 13, "js1_2": 13, "n_layer": 13, "rank_lay": 13, "elements_in_lay": 13, "variant": 13, "s3_3": 13, "check": 13, "ensur": 13, "compat": 13, "js0": 13, "js1": 13, "direct": 13, "l": [13, 19], "preserv": 13, "s2_1": 13, "behavior": 13, "trivial": [13, 15], "swap": 13, "sx0": 13, "five": 13, "s05_05": 13, "s01_05": 13, "s2": [13, 15], "sx2": 13, "overload": 13, "pin": 13, "span": 13, "j0": 13, "shape10": 13, "j1": 13, "freshli": 13, "wa": [13, 15], "lexicograph": 13, "print_shap": 13, "const": 13, "cout": 13, "print": 13, "s01_13": 13, "set_origin": 13, "11": 13, "12": 13, "unrol": 13, "6": [13, 15, 16], "rais": 13, "easili": 13, "document": [14, 18], "possess": 14, "effect": 14, "exactli": 14, "come": 14, "exhibit": [14, 15], "substanti": 14, "signific": 14, "space": [14, 15, 19], "save": 14, "op": 14, "properli": 14, "went": 15, "t_": 15, "ij": 15, "ab": 15, "symmetr": 15, "ji": 15, "definit": 15, "wast": 15, "larg": 15, "understand": 15, "antisymmetr": 15, "equal": [15, 21], "necessarili": 15, "disjoint": 15, "pairwis": 15, "ternari": 15, "cyclic": 15, "disclaim": 15, "coin": 15, "copi": [15, 21], "uniqu": 15, "posit": 15, "relat": 15, "basi": 15, "diagon": 15, "plu": 15, "separ": [15, 20], "rest": 15, "remain": 15, "straightforward": 15, "totallysymmetr": 15, "totallyantisymmetr": 15, "group": 15, "member": [15, 19], "henc": 15, "suffic": 15, "deriv": 15, "symmetryop": 15, "Of": [15, 20], "asymmetr": 15, "simplest": 15, "next": 15, "jaggedshap": 15, "chip": 15, "tediou": 15, "relev": 15, "s01": 15, "a01": 15, "s012": 15, "s01_2": 15, "s02_1": 15, "s12_0": 15, "a01_2": 15, "a02_1": 15, "a12_0": 15, "argument": 15, "subset": 15, "found": 15, "s01_a02": 15, "s01_a12": 15, "s02_a01": 15, "s02_a12": 15, "s12_a01": 15, "s12_a02": 15, "matter": 15, "a012": 15, "a0": 15, "a1": 15, "a2": 15, "a3": 15, "s01_s23": 15, "stand": 15, "s0123": 15, "block0": 15, "block1": 15, "block2": 15, "b0b1": 15, "b0b1b2": 15, "jag": 15, "long": [15, 21], "jblock0": 15, "jblock1": 15, "nblock0": 15, "nblock1": 15, "nb0nb1": 15, "sym": 15, "idea": 15, "best": [15, 21], "later": [15, 16, 20, 21], "upper": 15, "triangular": 15, "triangl": 15, "decid": 16, "tiledshap": 16, "8": 16, "dispatch": 16, "mu": 16, "occ": 16, "sublibrari": 18, "sparsemap": [18, 21, 22], "sparsifi": [18, 22], "notat": 19, "mathbb": 19, "rightarrow": 19, "denot": 19, "subspac": 19, "_": 19, "u_v": 19, "storag": 20, "union": 20, "intersect": 20, "domaintrait": 20, "domainpimpl": 20, "domainbas": 20, "envis": 20, "pimpl": 20, "semant": 20, "refactor": 20, "normal": 20, "redefin": 20, "mirror": 20, "elementindex": [20, 21], "tileindex": 20, "distarrai": 21, "worst": 21, "my": 21, "alia": 21, "kernel": 21, "flexibl": 21, "sm": 21, "tot": 21, "ind_rank": 21, "dep_rank": 21, "convers": 21, "former": 21, "valid": 21, "retriev": 21, "oppos": 21, "inject": 21, "reduc": 21, "insert": 21, "realiz": 21, "gut": 21, "from_sparse_tensor": 21, "ta": 21, "make_arrai": 21, "ind2mod": 21, "oeidx": 21, "oedix": 21, "empti": 21, "otherwis": 21, "injected_d": 21, "tdomain": 21, "itidx": 21, "ieidx": 21, "assumpt": 22, "make_tot_tile_": 22}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"tensorwrapp": [0, 1, 3, 9, 10, 12, 16, 18], "background": [0, 19], "content": [0, 17, 18, 22], "kei": [1, 20], "featur": 1, "design": [1, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 20], "wrap": [1, 6], "decoupl": 1, "express": [1, 8, 12], "layer": 1, "logic": 1, "v": 1, "actual": 1, "layout": [1, 7, 12], "math": 1, "nativ": 1, "support": 1, "nest": [1, 3, 13], "tensor": [1, 2, 3, 6, 7, 10, 13, 14, 15, 16, 21], "jag": [1, 3, 13], "exist": 2, "librari": [2, 20], "cyclop": 2, "framework": 2, "ctf": 2, "fastor": 2, "ftensor": 2, "intellig": 2, "itensor": 2, "libtensor": 2, "pytorch": 2, "algebra": 2, "compil": 2, "taco": 2, "c": 2, "tiledarrai": 2, "terminologi": [3, 6], "chip": [3, 13], "element": 3, "extent": 3, "mode": 3, "rank": 3, "shape": [3, 12, 13], "slice": [3, 13], "smooth": 3, "comput": 3, "scienc": 3, "abstract": 3, "syntax": 3, "tree": 3, "ast": 3, "concret": 3, "cst": 3, "domain": [3, 20], "specif": 3, "languag": 3, "dsl": [3, 10], "mathemat": 3, "field": 3, "refer": 4, "alloc": [5, 12], "consider": [5, 6, 7, 11, 12, 13, 14, 15, 20], "buffer": [6, 12], "what": [6, 7, 12, 13, 14, 15], "i": [6, 7, 12, 13, 14, 15], "why": [6, 7, 10, 12, 13, 14, 15], "do": [6, 7, 12, 13, 14, 15], "we": [6, 7, 12, 13, 14, 15], "need": [6, 7, 12, 13, 14, 15], "out": [6, 12, 15], "scope": [6, 12, 13, 15], "propos": [6, 13, 15, 16], "api": [6, 13, 15, 16], "creat": 6, "method": 6, "retriev": 6, "work": 6, "distribut": [6, 7, 16], "evalu": 6, "an": 6, "opgraph": [6, 11, 12], "compon": [8, 15], "motiv": [10, 11], "ar": 10, "suffici": 10, "overview": 12, "architectur": 12, "perform": 12, "user": 12, "face": 12, "class": [12, 16, 20], "symmetri": [12, 15], "sparsiti": [12, 14], "extern": 12, "depend": 12, "implement": 12, "": 13, "Not": 13, "shapebas": 13, "jaggedshap": 13, "tiledshap": 13, "indexedshap": 13, "construct": [13, 15, 16], "basic": [13, 15], "oper": 13, "composit": 13, "iter": 13, "summari": [13, 15], "consid": 15, "permut": 15, "object": 15, "translat": 15, "properti": 15, "addit": 15, "note": [15, 21], "easiest": 16, "non": 16, "trivial": 16, "declar": 16, "develop": 17, "document": 17, "sparsemap": [19, 20], "spars": [20, 22], "map": [20, 22], "hierarchi": 20, "sparsifi": 21, "thing": 21, "assumpt": 21, "make_tot_tile_": 21, "algorithm": 21, "sublibrari": 22}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinxcontrib.bibtex": 9, "sphinx": 57}, "alltitles": {"TensorWrapper Background": [[0, "tensorwrapper-background"]], "Contents:": [[0, null], [17, null], [18, null]], "Key Features of TensorWrapper": [[1, "key-features-of-tensorwrapper"]], "Design Features": [[1, "design-features"]], "Wrapping": [[1, "wrapping"]], "Decoupled Expression Layer": [[1, "decoupled-expression-layer"]], "Logical vs Actual Layout": [[1, "logical-vs-actual-layout"]], "Math Features": [[1, "math-features"]], "Native Support for Nested Tensors": [[1, "native-support-for-nested-tensors"]], "Native Support for Jagged Tensors": [[1, "native-support-for-jagged-tensors"]], "Existing Tensor Libraries": [[2, "existing-tensor-libraries"]], "Cyclops Tensor Framework (CTF)": [[2, "cyclops-tensor-framework-ctf"]], "Fastor": [[2, "fastor"]], "FTensor": [[2, "ftensor"]], "Intelligent Tensor (ITensor)": [[2, "intelligent-tensor-itensor"]], "libtensor": [[2, "libtensor"]], "PyTorch": [[2, "pytorch"]], "Tensor": [[2, "tensor"]], "Tensor Algebra Compiler (TACO)": [[2, "tensor-algebra-compiler-taco"]], "Tensor Library for C++": [[2, "tensor-library-for-c"]], "TiledArray": [[2, "tiledarray"]], "TensorWrapper Terminology": [[3, "tensorwrapper-terminology"]], "Tensor Terminology": [[3, "tensor-terminology"]], "chip": [[3, "chip"]], "element": [[3, "element"]], "extent": [[3, "extent"]], "jagged": [[3, "jagged"]], "mode": [[3, "mode"]], "nested": [[3, "nested"]], "rank": [[3, "rank"]], "shape": [[3, "shape"]], "slice": [[3, "slice"]], "smooth": [[3, "smooth"]], "Computer Science Terminology": [[3, "computer-science-terminology"]], "abstract syntax tree (AST)": [[3, "abstract-syntax-tree-ast"]], "concrete syntax tree (CST)": [[3, "concrete-syntax-tree-cst"]], "domain specific language (DSL)": [[3, "domain-specific-language-dsl"]], "Mathematics Terminology": [[3, "mathematics-terminology"]], "field": [[3, "field"]], "References": [[4, "references"]], "Designing the Allocator": [[5, "designing-the-allocator"]], "Allocator Considerations": [[5, "allocator-considerations"]], "Designing the Buffer": [[6, "designing-the-buffer"]], "What is the Buffer?": [[6, "what-is-the-buffer"]], "Why do we need a Buffer?": [[6, "why-do-we-need-a-buffer"]], "Buffer Terminology": [[6, "buffer-terminology"]], "Buffer Considerations": [[6, "buffer-considerations"]], "Out of Scope": [[6, "out-of-scope"]], "Proposed APIs": [[6, "proposed-apis"], [15, "proposed-apis"], [16, "proposed-apis"]], "Creating a Buffer": [[6, "creating-a-buffer"]], "Buffer Methods": [[6, "buffer-methods"]], "Retrieving the Wrapped Tensor": [[6, "retrieving-the-wrapped-tensor"]], "Working with Distributed Buffers": [[6, "working-with-distributed-buffers"]], "Evaluating an OpGraph": [[6, "evaluating-an-opgraph"]], "Buffer Design": [[6, "buffer-design"]], "Layout Design": [[7, "layout-design"]], "What is a (tensor) distribution?": [[7, "what-is-a-tensor-distribution"]], "Why do we need a (tensor) distribution?": [[7, "why-do-we-need-a-tensor-distribution"]], "Tensor distribution considerations": [[7, "tensor-distribution-considerations"]], "Designing the Expression Component": [[8, "designing-the-expression-component"]], "Design of TensorWrapper": [[9, "design-of-tensorwrapper"]], "Motivating TensorWrapper": [[10, "motivating-tensorwrapper"]], "Why Tensors?": [[10, "why-tensors"]], "Are tensors a sufficient DSL?": [[10, "are-tensors-a-sufficient-dsl"]], "Why TensorWrapper?": [[10, "why-tensorwrapper"]], "Designing the OpGraph": [[11, "designing-the-opgraph"]], "OpGraph Considerations": [[11, "opgraph-considerations"]], "OpGraph Motivations": [[11, "opgraph-motivations"]], "Overview of TensorWrapper": [[12, "overview-of-tensorwrapper"]], "What is TensorWrapper?": [[12, "what-is-tensorwrapper"]], "Why do we need TensorWrapper?": [[12, "why-do-we-need-tensorwrapper"]], "Architecture Considerations": [[12, "architecture-considerations"]], "Performance Considerations": [[12, "performance-considerations"]], "Out of Scope Considerations": [[12, "out-of-scope-considerations"], [15, "out-of-scope-considerations"]], "Architecture Design": [[12, "architecture-design"]], "User-Facing Classes": [[12, "user-facing-classes"]], "Shape": [[12, "shape"], [13, "shape"]], "Symmetry": [[12, "symmetry"]], "Sparsity": [[12, "sparsity"]], "TensorWrapper": [[12, "tensorwrapper"], [18, "tensorwrapper"]], "User-Facing External Dependencies": [[12, "user-facing-external-dependencies"]], "Implementation-Facing Classes": [[12, "implementation-facing-classes"]], "Allocator": [[12, "allocator"]], "Buffer": [[12, "buffer"]], "Layout": [[12, "layout"]], "Expression": [[12, "expression"]], "OpGraph": [[12, "opgraph"]], "Implementation-Facing External Dependencies": [[12, "implementation-facing-external-dependencies"]], "Tensor Shape Design": [[13, "tensor-shape-design"]], "What is a tensor\u2019s shape?": [[13, "what-is-a-tensor-s-shape"]], "Why do we need a tensor\u2019s shape?": [[13, "why-do-we-need-a-tensor-s-shape"]], "Shape Considerations": [[13, "shape-considerations"]], "Not in Scope": [[13, "not-in-scope"]], "Shape Design": [[13, "id1"]], "ShapeBase": [[13, "shapebase"]], "JaggedShape": [[13, "jaggedshape"]], "TiledShape": [[13, "tiledshape"]], "Nested": [[13, "nested"]], "IndexedShape": [[13, "indexedshape"]], "Proposed Shape APIs": [[13, "proposed-shape-apis"]], "Constructing a Shape": [[13, "constructing-a-shape"]], "Jagged Shape Construction": [[13, "jagged-shape-construction"]], "Constructing Nested Shapes": [[13, "constructing-nested-shapes"]], "Basic Operations": [[13, "basic-operations"]], "Shape Composition": [[13, "shape-composition"]], "Slicing and Chipping": [[13, "slicing-and-chipping"]], "Iterating": [[13, "iterating"]], "Summary": [[13, "summary"], [15, "summary"]], "Tensor Sparsity Design": [[14, "tensor-sparsity-design"]], "What is tensor sparsity?": [[14, "what-is-tensor-sparsity"]], "Why do we need tensor sparsity?": [[14, "why-do-we-need-tensor-sparsity"]], "Sparsity considerations": [[14, "sparsity-considerations"]], "Designing the Symmetry Component": [[15, "designing-the-symmetry-component"]], "What is (tensor) symmetry?": [[15, "what-is-tensor-symmetry"]], "Why do we need to consider symmetry?": [[15, "why-do-we-need-to-consider-symmetry"]], "Symmetry Considerations": [[15, "symmetry-considerations"]], "Symmetry Design": [[15, "symmetry-design"]], "Constructing Permutational Symmetry Objects": [[15, "constructing-permutational-symmetry-objects"]], "Constructing Symmetry Objects with Translational Symmetry": [[15, "constructing-symmetry-objects-with-translational-symmetry"]], "Basic Properties": [[15, "basic-properties"]], "Additional Notes": [[15, "additional-notes"]], "Designing TensorWrapper Class": [[16, "designing-tensorwrapper-class"]], "Easiest Non-Trivial Construction": [[16, "easiest-non-trivial-construction"]], "Declaring a Distributed Tensor": [[16, "declaring-a-distributed-tensor"]], "Developer Documentation": [[17, "developer-documentation"]], "SparseMap Background": [[19, "sparsemap-background"]], "Sparse Map Library Design": [[20, "sparse-map-library-design"]], "Key Considerations": [[20, "key-considerations"]], "Domain Class Hierarchy": [[20, "domain-class-hierarchy"]], "SparseMap Class Hierarchy": [[20, "sparsemap-class-hierarchy"]], "Sparsifying a Tensor": [[21, "sparsifying-a-tensor"]], "Things to note": [[21, "things-to-note"]], "Assumptions": [[21, "assumptions"]], "make_tot_tile_ Algorithm": [[21, "make-tot-tile-algorithm"]], "Sparse Maps Sublibrary": [[22, "sparse-maps-sublibrary"]], "Contents": [[22, null]]}, "indexentries": {}})